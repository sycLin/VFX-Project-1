function HDRImg = getHDR(images, g, lt, w)
    row = size(images{1}(:,:,1), 1); 
    col = size(images{1}(:,:,1), 2);
    imageNum = size(images, 2);
    HDRlnE = zeros(row, col, 3);
    
    tt = reshape(images{1}(:,:,1), row*col,1);
    y0 = linspace(1,256,256);
    x0 = tt()
    
    y = linspace(1,256,256);
    x1 = g(y,1);
    x2 = g(y,2);
    x3 = g(y,3);
    figure
    plot(x1, y, 'r', x2, y, 'g', x3, y, 'b')
    
    for channel=1:3
        for r=1:row
            for c=1:col
                sumWeightedlE = 0;
                sumWeight = 0;
                for j=1:imageNum
                    tmpZ = images{j}(row,col,channel) + 1;
                    tmpg = g(tmpZ,channel);
                    tmplt = lt(j);
                    sumWeightedlE = sumWeightedlE + w(tmpZ)*(tmpg - tmplt);
                    sumWeight = sumWeight + w(tmpZ);
                end
                HDRlnE(r, c, channel) = exp(sumWeightedlE/sumWeight);
            end
        end
    end
    HDRImg = HDRlnE;
end